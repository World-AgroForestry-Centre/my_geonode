{% extends "upload/layer_upload_base.html" %}
{% load i18n %}
{% load staticfiles %}

{% block title %} {% trans "Upload Layer"  %} - {{ block.super }}  {% endblock %}

{% block body_class %}layers upload{% endblock %}


{% block head %}

{{ block.super }}
{% endblock %}

{% block body_outer %}
<div class="page-header">
  <a href="{% url "layer_browse" %}" class="btn btn-primary pull-right">{% trans "Explore Layers" %}</a>
  <h2 class="page-title">{% trans "Upload Layers" %}</h2>
</div>


<div class="row">

  <div id="upload-section1" class="col-md-8">
    {% include "upload/files.html" %}
    <section class="buttons">
      <a href="#" id="clear-button" class="btn btn-default">{% trans "Clear" %}</a>
      <a href="#" id="goToSection2" class="btn btn-danger">{% trans "Next" %}</a>
    </section>
  </div>
  
  <div id="upload-section2" class="col-md-8">
    {% include "upload/metadata.html" %}
    <section class="buttons">
      <a href="#" id="goToSection1" class="btn btn-default">{% trans "Prev" %}</a>
      {% if GEONODE_SECURITY_ENABLED %}
        <a href="#" id="goToSection3" class="btn btn-danger">{% trans "Next" %}</a>
      {% else %}
        <a href="#" id="upload-button" class="btn btn-danger">{% trans "Upload files" %}</a>
      {% endif %}
    </section>
  </div>

  {% if GEONODE_SECURITY_ENABLED %}
    <div id="upload-section3" class="col-md-8">
      <h3>{% trans "Permissions"  %}</h3>
      <form id="permission_form">
        {% include "_permissions.html" %}
      </form>
      <section class="buttons">
        <a href="#" id="goToSection2" class="btn btn-default">{% trans "Prev" %}</a>
        <a href="#" id="upload-button" class="btn btn-danger">{% trans "Upload files" %}</a>
      </section>
    </div>
  {% endif %}

  <div id="error-section" class="col-md-8">
    <div id="upload-status"></div>
    {% if errors %}
      <div id="errors" class="alert alert-danger">
        {% for error in errors %}
          <p>{{ error }}</p>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}


{% block extra_script %}
<script data-main="{% static 'geonode/js/upload/main' %}" 
  src="{% static 'lib/js/require.js' %}">
</script>

<script type="text/javascript">
{% autoescape off %}

  csrf_token =  "{{ csrf_token }}",
  form_target = "{{ UPLOADER_URL }}",
  geogig_enabled = {{ GEOGIG_ENABLED|lower  }},
  time_enabled = {{ TIME_ENABLED|lower  }},
  userLookup = "{% url "geonode.views.ajax_lookup" %}"

{% endautoescape %}

</script>
{% if GEONODE_SECURITY_ENABLED %}
{% with resource=layer %}
{% include "_permissions_form_js.html" %}
{% endwith %}
{% endif %}
{% endblock extra_script %}
